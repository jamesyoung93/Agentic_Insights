graph LR
    %% Agentic Insights Architecture

    subgraph Sources
        CSV[("Customer<br/>Data CSV")]
        LIT[("Literature<br/>Index")]
        API{{OpenAI<br/>API}}
    end

    subgraph Processing
        UI[Streamlit<br/>UI]
        DA[Data<br/>Analyst]
        LS[Literature<br/>Searcher]
        STATS[Statistical<br/>Analysis]
    end

    subgraph Storage
        WM[World<br/>Model]
        STATE[("Session<br/>State")]
    end

    subgraph Outputs
        RPT[/Enhanced<br/>Report/]
        CODE[/Generated<br/>Code/]
        DASH[/Interactive<br/>Dashboard/]
    end

    %% Data flows
    CSV -->|pandas.read_csv| UI
    LIT -->|JSON load| LS
    UI -->|Run analysis| DA
    UI -.->|Search query| LS
    DA -.->|Generate code| API
    LS -.->|Extract insights| API
    UI -.->|Synthesize| API
    DA -->|scipy/numpy| STATS
    STATS -->|Add trajectory| WM
    WM -->|Persist JSON| STATE
    WM -->|Generate report| RPT
    DA -->|Save .py files| CODE
    STATE -->|Render state| DASH
    WM -->|Show discoveries| DASH

    style CSV fill:#fff
    style LIT fill:#fff
    style API fill:#ffface
    style STATE fill:#fff
    style RPT fill:#e6f0ff
    style CODE fill:#e6f0ff
    style DASH fill:#e6f0ff
